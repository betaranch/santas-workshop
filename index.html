<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Santa's Workshop Lounge - AI Snapshot</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-hunter: #0f2f24;
            --color-hunter-dark: #081911;
            --color-hunter-soft: rgba(15, 47, 36, 0.78);
            --color-spruce: #1a3b2d;
            --color-cream: #f4efe5;
            --color-cream-soft: rgba(244, 239, 229, 0.9);
            --color-stone: #d9d4c7;
            --color-ink: #1f1a1b;
            --color-ink-soft: rgba(31, 26, 27, 0.7);
            --color-gold: #e4b567;
            --color-gold-soft: rgba(228, 181, 103, 0.32);
            --color-cranberry: #7a1f30;
            --radius-card: 28px;
            --radius-inner: 18px;
            --shadow-elevated: 0 28px 60px rgba(8, 15, 20, 0.45);
            --transition: all 0.25s ease;
            --max-width: 960px;
            --toast-success: rgba(46, 120, 92, 0.94);
            --toast-warning: rgba(213, 140, 32, 0.94);
            --toast-error: rgba(180, 48, 48, 0.94);
            --toast-info: rgba(36, 82, 124, 0.94);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Segoe UI', sans-serif;
            background:
                radial-gradient(circle at top left, rgba(228, 181, 103, 0.2), transparent 55%),
                radial-gradient(circle at bottom right, rgba(244, 239, 229, 0.24), transparent 60%),
                linear-gradient(145deg, var(--color-hunter-dark) 0%, var(--color-hunter) 55%, #131b16 100%);
            color: var(--color-ink);
            min-height: 100vh;
            margin: 0;
            padding: 56px 16px 72px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            position: relative;
            overflow-x: hidden;
        }

        body::after {
            content: "";
            position: fixed;
            inset: 0;
            background-image: radial-gradient(rgba(255, 255, 255, 0.22) 1px, transparent 1px);
            background-size: 140px 140px;
            opacity: 0.32;
            pointer-events: none;
            mix-blend-mode: screen;
        }

        main {
            position: relative;
            width: 100%;
            max-width: var(--max-width);
            z-index: 1;
        }

        .lounge-card {
            background: linear-gradient(160deg, var(--color-cream) 0%, var(--color-cream-soft) 100%);
            border-radius: var(--radius-card);
            box-shadow: var(--shadow-elevated);
            border: 1px solid var(--color-gold-soft);
            padding: clamp(32px, 4vw, 60px);
            position: relative;
            overflow: hidden;
        }

        .lounge-card::before {
            content: "";
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at top right, rgba(242, 192, 120, 0.32), transparent 45%);
            pointer-events: none;
        }

        .hero {
            text-align: center;
            margin-bottom: 36px;
            position: relative;
            z-index: 1;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            padding: 10px 20px;
            border-radius: 999px;
            background: rgba(122, 31, 48, 0.14);
            border: 1px solid rgba(122, 31, 48, 0.24);
            color: rgba(122, 31, 48, 0.82);
            font-size: 0.9rem;
            letter-spacing: 0.08em;
            text-transform: uppercase;
        }

        .badge .dot {
            color: rgba(122, 31, 48, 0.35);
        }

        h1 {
            font-family: 'Playfair Display', serif;
            font-size: clamp(2.2rem, 4.2vw, 3.1rem);
            margin-top: 18px;
            margin-bottom: 6px;
            color: var(--color-ink);
            letter-spacing: 0.01em;
        }

        .hero-subtitle {
            font-family: 'Playfair Display', serif;
            font-size: clamp(1.4rem, 3.2vw, 2rem);
            color: var(--color-hunter);
            letter-spacing: 0.12em;
            text-transform: uppercase;
            margin-bottom: 18px;
        }

        .hero p {
            max-width: 640px;
            margin: 0 auto;
            color: var(--color-ink-soft);
            font-size: 1.05rem;
            line-height: 1.65;
        }

        .status-card {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            background: linear-gradient(140deg, rgba(15, 47, 36, 0.16) 0%, rgba(228, 181, 103, 0.12) 100%);
            border: 1px solid var(--color-gold-soft);
            border-radius: var(--radius-inner);
            padding: 22px 26px;
            margin-bottom: 28px;
            position: relative;
        }

        .status-card::after {
            content: "";
            position: absolute;
            inset: 0;
            border-radius: inherit;
            border: 1px solid rgba(255, 255, 255, 0.18);
            pointer-events: none;
        }

        .status-block {
            position: relative;
        }

        .status-action {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: flex-start;
        }

        .status-action .btn-ghost {
            align-self: flex-start;
            background: rgba(255, 255, 255, 0.85);
            color: var(--color-hunter);
            border: 1px solid rgba(15, 47, 36, 0.28);
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .status-action .btn-ghost:hover,
        .status-action .btn-ghost:focus-visible {
            background: rgba(15, 47, 36, 0.08);
            color: var(--color-hunter-dark);
        }



        .status-label {
            display: block;
            font-size: 0.78rem;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: rgba(31, 26, 27, 0.55);
            margin-bottom: 6px;
        }

        .status-value {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--color-ink);
        }

        .status-sub {
            margin-top: 6px;
            color: rgba(31, 26, 27, 0.58);
            font-size: 0.95rem;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 16px;
            margin-bottom: 18px;
            position: relative;
            z-index: 1;
        }

        .btn {
            border: none;
            border-radius: 18px;
            padding: 20px 22px;
            text-align: left;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            gap: 6px;
            text-decoration: none;
            color: inherit;
            box-shadow: 0 18px 35px rgba(12, 34, 34, 0.15);
        }

        .btn .btn-title {
            font-size: 1.15rem;
        }

        .btn .btn-sub {
            font-size: 0.92rem;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.85);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--color-hunter) 0%, var(--color-hunter-dark) 100%);
            color: #fdfbf6;
        }

        .btn-primary:hover,
        .btn-primary:focus-visible {
            transform: translateY(-2px);
            background: linear-gradient(135deg, var(--color-hunter-soft) 0%, var(--color-hunter-dark) 100%);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--color-spruce) 0%, var(--color-hunter) 100%);
            color: #fdfbf6;
        }

        .btn-secondary .btn-sub {
            color: rgba(253, 251, 246, 0.82);
        }

        .btn-secondary:hover,
        .btn-secondary:focus-visible {
            transform: translateY(-2px);
            background: linear-gradient(135deg, var(--color-hunter) 0%, var(--color-hunter-dark) 100%);
        }

        .btn-outline {
            background: rgba(255, 255, 255, 0.82);
            color: var(--color-hunter);
            border: 1px solid rgba(15, 47, 36, 0.25);
            box-shadow: 0 18px 30px rgba(12, 34, 34, 0.12);
        }

        .btn-outline .btn-sub {
            color: rgba(15, 47, 36, 0.68);
        }

        .btn-outline:hover,
        .btn-outline:focus-visible {
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.95);
        }

        .shortcut-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 30px;
        }

        .shortcut {
            background: rgba(15, 47, 36, 0.14);
            color: var(--color-hunter);
            border: 1px solid rgba(15, 47, 36, 0.28);
            border-radius: 999px;
            padding: 10px 18px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .shortcut:hover,
        .shortcut:focus-visible {
            background: rgba(15, 47, 36, 0.24);
            transform: translateY(-1px);
        }

        .guide-card {
            background: rgba(255, 255, 255, 0.85);
            border-radius: var(--radius-inner);
            border: 1px solid var(--color-gold-soft);
            padding: 26px;
            margin-bottom: 26px;
        }

        .guide-card h2 {
            font-family: 'Playfair Display', serif;
            font-size: 1.45rem;
            margin-bottom: 14px;
        }

        .guide-card ol {
            color: var(--color-ink-soft);
            padding-left: 20px;
            line-height: 1.65;
        }

        .guide-card li {
            margin-bottom: 12px;
        }

        .footer {
            text-align: center;
            color: rgba(31, 26, 27, 0.55);
            font-size: 0.9rem;
        }

        .btn:focus-visible,
        .shortcut:focus-visible {
            outline: 2px solid rgba(242, 192, 120, 0.6);
            outline-offset: 3px;
        }

        .toast-container {
            position: fixed;
            top: 24px;
            right: 24px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            z-index: 999;
        }

        .toast {
            display: flex;
            gap: 12px;
            border-radius: 16px;
            padding: 14px 18px;
            color: #fefdfb;
            min-width: 260px;
            max-width: 360px;
            box-shadow: 0 16px 34px rgba(8, 15, 20, 0.45);
            border-left: 4px solid rgba(255, 255, 255, 0.6);
            animation: toast-in 0.32s ease forwards;
        }

        @keyframes toast-in {
            from {
                opacity: 0;
                transform: translateY(-12px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .toast strong {
            font-size: 0.95rem;
            display: block;
            margin-bottom: 4px;
        }

        .toast p {
            font-size: 0.86rem;
            line-height: 1.42;
        }

        .toast button {
            background: none;
            border: none;
            color: inherit;
            cursor: pointer;
            margin-left: auto;
            padding: 4px;
            font-size: 1rem;
        }

        .toast-success { background: var(--toast-success); }
        .toast-warning { background: var(--toast-warning); }
        .toast-error { background: var(--toast-error); }
        .toast-info { background: var(--toast-info); }

        .loading-overlay {
            position: fixed;
            inset: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(10, 18, 26, 0.45);
            backdrop-filter: blur(6px);
            -webkit-backdrop-filter: blur(6px);
            z-index: 900;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .loading-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .loader {
            text-align: center;
            color: #f6f3ea;
        }

        .loader-ring {
            width: 54px;
            height: 54px;
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-top-color: #f6f3ea;
            border-radius: 50%;
            margin: 0 auto 12px;
            animation: spin 1.1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        @media (max-width: 820px) {
            body {
                padding: 42px 12px 56px;
            }

        }

        @media (max-width: 560px) {
            .toast-container {
                right: 12px;
                left: 12px;
            }

            .toast {
                max-width: none;
            }

            .badge {
                font-size: 0.82rem;
            }
        }
    </style>
</head>
<body>
    <main>
        <section class="lounge-card" role="region" aria-labelledby="page-title">
            <header class="hero">
                <div class="badge">
                    <span>Elf Speakeasy</span>
                    <span class="dot">&bull;</span>
                    <span>Bend, Oregon</span>
                </div>
                <h1 id="page-title">Santa's Workshop Lounge</h1>
                <h2 class="hero-subtitle">AI Snapshot</h2>
                <p>
                    A festive command center for Design, Operations, and Marketing leads to collect the latest project intelligence before briefing their AI copilots.
                </p>
            </header>

            <div class="status-card" aria-live="polite">
                <div class="status-block">
                    <span class="status-label">Latest Snapshot</span>
                    <p class="status-value" id="last-updated">Connecting to GitHub...</p>
                    <p class="status-sub"><span id="next-refresh">Next refresh pending</span></p>
                </div>
                <div class="status-block">
                    <span class="status-label">File Details</span>
                    <p class="status-value"><span id="line-count">&mdash; lines</span></p>
                    <p class="status-sub"><span id="token-count">~&mdash; tokens</span> &bull; <span id="file-size">&mdash;</span></p>
                </div>
                <div class="status-block status-action">
                    <span class="status-label">Manual refresh</span>
                    <button type="button" class="btn-ghost" id="create-snapshot">Create new snapshot</button>
                </div>
            </div>

            <div class="actions-grid" role="group" aria-label="Primary snapshot actions">
                <button type="button" class="btn btn-primary" id="download-button">
                    <span class="btn-title">Download Snapshot</span>
                    <span class="btn-sub">Save the latest markdown locally</span>
                </button>
                <button type="button" class="btn btn-secondary" id="copy-button">
                    <span class="btn-title">Copy to Clipboard</span>
                    <span class="btn-sub">Paste directly into your AI assistant</span>
                </button>
                <a class="btn btn-outline" id="view-raw" href="https://raw.githubusercontent.com/betaranch/santas-workshop/main/LATEST_SNAPSHOT.md" target="_blank" rel="noopener">
                    <span class="btn-title">View Raw File</span>
                    <span class="btn-sub">Opens the GitHub-hosted snapshot</span>
                </a>
            </div>

            <div class="shortcut-grid" role="group" aria-label="Quick AI launchers">
                <button type="button" class="shortcut" data-target="https://claude.ai/new">Copy &amp; open Claude</button>
                <button type="button" class="shortcut" data-target="https://chat.openai.com/">Copy &amp; open ChatGPT</button>
                <button type="button" class="shortcut" data-target="https://grok.com">Copy &amp; open Grok</button>
            </div>


            <section class="guide-card">
                <h2>How the lounge works</h2>
                <ol>
                    <li>Tap Download or Copy to grab the freshest briefing ? the toast confirms when the snapshot is saved.</li>
                    <li>Launch your preferred AI assistant (Claude, ChatGPT, Grok) and paste or upload the markdown file.</li>
                    <li>Prompt for opportunities, risks, and next moves tailored to your lane, then record highlights in Notion.</li>
                    <li>Need something sooner? Use "Create new snapshot" to pull fresh data before the six-hour cadence, then log highlights in Notion.</li>
                </ol>
            </section>

            <footer class="footer">
                <p>Powered by Santa's Workshop GitHub Actions. Snapshots publish every six hours; manual refresh pulls straight from main.</p>
            </footer>
        </section>
    </main>

    <div id="toast-container" class="toast-container" aria-live="assertive" aria-atomic="true"></div>

    <div id="loading-overlay" class="loading-overlay" role="alert" aria-live="assertive" aria-hidden="true">
        <div class="loader">
            <div class="loader-ring"></div>
            <p>Stirring up a fresh snapshot...</p>
        </div>
    </div>

    <pre id="snapshot-full" class="visually-hidden"></pre>
    <script>
        (function () {
            const SNAPSHOT_URL = 'https://raw.githubusercontent.com/betaranch/santas-workshop/main/LATEST_SNAPSHOT.md';
            const CACHE_KEY = 'santas-workshop-snapshot-cache-v2';
            const SIX_HOUR_MS = 6 * 60 * 60 * 1000;

            const numberFormatter = new Intl.NumberFormat('en-US');

            const fullEl = document.getElementById('snapshot-full');
            const fileSizeEl = document.getElementById('file-size');
            const lineCountEl = document.getElementById('line-count');
            const tokenCountEl = document.getElementById('token-count');
            const lastUpdatedEl = document.getElementById('last-updated');
            const nextRefreshEl = document.getElementById('next-refresh');
            const loaderEl = document.getElementById('loading-overlay');
            const toastContainer = document.getElementById('toast-container');
            const downloadButton = document.getElementById('download-button');
            const copyButton = document.getElementById('copy-button');
            const createSnapshotButton = document.getElementById('create-snapshot');
            const shortcutButtons = document.querySelectorAll('.shortcut[data-target]');

            let snapshotContent = '';
            init();

            function init() {
                const cached = readCache();
                if (cached) {
                    hydrateSnapshot(cached, { silent: true, source: 'cache' });
                }
                loadSnapshot().catch(() => {
                    /* handled in loadSnapshot */
                });
                bindEvents();
            }

            function bindEvents() {
                if (downloadButton) {
                    downloadButton.addEventListener('click', downloadSnapshot);
                }
                if (copyButton) {
                    copyButton.addEventListener('click', () => copySnapshot());
                }
                if (createSnapshotButton) {
                    createSnapshotButton.addEventListener('click', handleManualRefresh);
                }
                shortcutButtons.forEach((button) => {
                    button.addEventListener('click', () => handleShortcut(button.dataset.target));
                });
            }

            function readCache() {
                try {
                    const raw = localStorage.getItem(CACHE_KEY);
                    if (!raw) {
                        return null;
                    }
                    return JSON.parse(raw);
                } catch (error) {
                    console.warn('Unable to read snapshot cache', error);
                    return null;
                }
            }

            function writeCache(payload) {
                try {
                    localStorage.setItem(CACHE_KEY, JSON.stringify(payload));
                } catch (error) {
                    console.warn('Unable to write snapshot cache', error);
                }
            }

            async function loadSnapshot({ force = false } = {}) {
                showLoader(true);
                try {
                    const response = await fetch(SNAPSHOT_URL, { cache: 'no-store' });
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    const text = await response.text();
                    const payload = {
                        content: text,
                        fetchedAt: new Date().toISOString(),
                        lastModified: response.headers.get('last-modified') || null,
                        size: getSizeInBytes(response, text)
                    };
                    hydrateSnapshot(payload, { source: 'network' });
                    writeCache(payload);
                    showToast('Snapshot refreshed from GitHub.', 'success');
                    return payload;
                } catch (error) {
                    console.error('Snapshot fetch failed', error);
                    const cached = readCache();
                    if (cached && !force) {
                        hydrateSnapshot(cached, { source: 'cache' });
                        showToast('Using your last saved snapshot while GitHub tries again.', 'warning');
                    } else {
                        showToast('Could not reach GitHub. Please try again soon.', 'error');
                    }
                    throw error;
                } finally {
                    showLoader(false);
                }
            }

            function hydrateSnapshot(payload, { silent = false, source = 'network' } = {}) {
                snapshotContent = payload.content || '';
                fullEl.textContent = snapshotContent;

                const lines = snapshotContent.split('\n');
                const approxTokens = estimateTokens(snapshotContent);

                if (fileSizeEl) {
                    fileSizeEl.textContent = formatBytes(payload.size);
                }
                if (lineCountEl) {
                    lineCountEl.textContent = formatNumber(lines.length) + ' lines';
                }
                if (tokenCountEl) {
                    tokenCountEl.textContent = '~' + formatNumber(approxTokens) + ' tokens';
                }

                const originDate = parseDate(payload.lastModified) || parseDate(payload.fetchedAt) || new Date();
                lastUpdatedEl.textContent = formatDateTime(originDate);
                updateNextRefresh(originDate);

                if (!silent) {
                    const label = source === 'cache' ? 'Loaded cached snapshot.' : 'Snapshot ready for download.';
                    showToast(label, 'info');
                }
            }

            function downloadSnapshot() {
                if (!ensureSnapshotReady()) {
                    return;
                }
                const blob = new Blob([snapshotContent], { type: 'text/markdown' });
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                const stamp = new Date().toISOString().slice(0, 10);
                link.download = 'santas_workshop_snapshot_' + stamp + '.md';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);
                showToast('Snapshot downloaded to your device.', 'success');
            }

            async function copySnapshot({ silent = false } = {}) {
                if (!ensureSnapshotReady()) {
                    return false;
                }
                try {
                    await navigator.clipboard.writeText(snapshotContent);
                    if (!silent) {
                        showToast('Snapshot copied to clipboard.', 'success');
                    }
                    return true;
                } catch (error) {
                    const textarea = document.createElement('textarea');
                    textarea.value = snapshotContent;
                    textarea.setAttribute('readonly', '');
                    textarea.style.position = 'fixed';
                    textarea.style.left = '-9999px';
                    document.body.appendChild(textarea);
                    textarea.focus();
                    textarea.select();
                    try {
                        const succeeded = document.execCommand('copy');
                        if (succeeded && !silent) {
                            showToast('Snapshot copied to clipboard.', 'success');
                        }
                        return succeeded;
                    } catch (fallbackError) {
                        showToast('Unable to copy automatically. Please download the file instead.', 'error');
                        return false;
                    } finally {
                        document.body.removeChild(textarea);
                    }
                }
            }

            function ensureSnapshotReady() {
                if (!snapshotContent) {
                    showToast('Snapshot is still loading. Try again in a moment.', 'warning');
                    return false;
                }
                return true;
            }

            async function handleShortcut(url) {
                if (!url) {
                    return;
                }
                const success = await copySnapshot({ silent: true });
                if (success) {
                    showToast('Snapshot copied. Opening your assistant in a new tab.', 'success');
                    window.open(url, '_blank', 'noopener');
                }
            }

            function handleManualRefresh() {
                loadSnapshot({ force: true }).catch(() => {});
            }

            function getSizeInBytes(response, text) {
                const headerValue = response.headers.get('content-length');
                if (headerValue) {
                    const parsed = parseInt(headerValue, 10);
                    if (!Number.isNaN(parsed)) {
                        return parsed;
                    }
                }
                if (typeof TextEncoder !== 'undefined') {
                    return new TextEncoder().encode(text).length;
                }
                return text.length;
            }

            function parseDate(value) {
                if (!value) {
                    return null;
                }
                const date = new Date(value);
                return Number.isNaN(date.getTime()) ? null : date;
            }

            function formatDateTime(date) {
                return date.toLocaleString('en-US', {
                    weekday: 'short',
                    month: 'short',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit',
                    timeZoneName: 'short'
                });
            }

            function updateNextRefresh(date) {
                if (!nextRefreshEl) {
                    return;
                }
                if (!date) {
                    nextRefreshEl.textContent = 'Next refresh schedule unavailable';
                    return;
                }
                const nextDate = new Date(date.getTime() + SIX_HOUR_MS);
                const now = new Date();
                const label = nextDate < now
                    ? 'Next refresh overdue; expected ' + formatDateTime(nextDate)
                    : 'Next refresh at ' + formatDateTime(nextDate);
                nextRefreshEl.textContent = label;
            }

            function formatNumber(value) {
                return numberFormatter.format(value);
            }

            function estimateTokens(text) {
                if (!text) {
                    return 0;
                }
                return Math.max(1, Math.round(text.length / 4));
            }

            function formatBytes(bytes) {
                if (!bytes || Number.isNaN(bytes)) {
                    return 'Size unknown';
                }
                const units = ['B', 'KB', 'MB', 'GB'];
                let value = bytes;
                let unitIndex = 0;
                while (value >= 1024 && unitIndex < units.length - 1) {
                    value /= 1024;
                    unitIndex += 1;
                }
                const decimals = value < 10 && unitIndex > 0 ? 1 : 0;
                return value.toFixed(decimals) + ' ' + units[unitIndex];
            }

            function showLoader(active) {
                if (!loaderEl) {
                    return;
                }
                if (active) {
                    loaderEl.classList.add('active');
                    loaderEl.setAttribute('aria-hidden', 'false');
                } else {
                    loaderEl.classList.remove('active');
                    loaderEl.setAttribute('aria-hidden', 'true');
                }
            }

            function showToast(message, type = 'info') {
                if (!toastContainer) {
                    return;
                }
                const titles = {
                    success: 'Success',
                    warning: 'Heads up',
                    error: 'Something went wrong',
                    info: 'Update'
                };
                const toast = document.createElement('div');
                const role = type === 'error' ? 'alert' : 'status';
                toast.className = 'toast toast-' + type;
                toast.setAttribute('role', role);
                toast.innerHTML = '<div><strong>' + (titles[type] || 'Update') + '</strong><p>' + message + '</p></div>';

                const closeButton = document.createElement('button');
                closeButton.setAttribute('type', 'button');
                closeButton.setAttribute('aria-label', 'Dismiss message');
                closeButton.innerHTML = '&times;';
                closeButton.addEventListener('click', () => removeToast(toast));

                toast.appendChild(closeButton);
                toastContainer.appendChild(toast);

                window.setTimeout(() => removeToast(toast), 6000);
            }

            function removeToast(toast) {
                if (!toast || !toast.parentNode) {
                    return;
                }
                toast.style.opacity = '0';
                toast.style.transform = 'translateY(-10px) scale(0.97)';
                window.setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 220);
            }
        })();
    </script>
</body>
</html>
